
-- Sample DDL for RDBMS tables to hold mapa output
-- An awk script to split the mapa output into separate
-- files suitable for loading into these tables is 
-- called mapaOutputSplit.

CREATE TABLE MAPA_JCL_FILE
  ( JCL_FILE_KEY           CHAR(36) 
    PRIMARY KEY
  , FILE_NAME              VARCHAR(255)
  , FILE_PROCESS_TIMESTAMP TIMESTAMP
  );

CREATE TABLE MAPA_JCL_JOB
  ( JCL_JOB_KEY            CHAR(36) 
    PRIMARY KEY
  , JCL_FILE_KEY           CHAR(36) 
    REFERENCES MAPA_JCL_FILE
    ON DELETE CASCADE
  , JOB_NAME               VARCHAR(255)
  , JOB_ORDINAL_NUMBER     INTEGER
  );

CREATE TABLE MAPA_JCL_PROC
  ( JCL_PROC_KEY           CHAR(36) 
    PRIMARY KEY
  , JCL_FILE_KEY           CHAR(36) 
    REFERENCES MAPA_JCL_FILE
    ON DELETE CASCADE
  , PROC_NAME              VARCHAR(255)
  );

CREATE TABLE MAPA_JCL_JOB_STEP
  ( JCL_JOB_STEP_KEY CHAR(36) 
    PRIMARY KEY
  , JCL_JOB_KEY CHAR(36) 
    REFERENCES MAPA_JCL_JOB
    ON DELETE CASCADE
  , STEP_NAME VARCHAR(255)
  , JOB_ORDINAL_NUMBER INTEGER
  , STEP_TYPE CHAR(4)
  , EXEC_TARGET VARCHAR(8)
  );

CREATE TABLE MAPA_JCL_PROC_STEP
  ( JCL_PROC_STEP_KEY CHAR(36) 
    PRIMARY KEY
  , JCL_PROC_KEY CHAR(36) 
    REFERENCES MAPA_JCL_PROC
    ON DELETE CASCADE
  , STEP_NAME VARCHAR(255)
  , PROC_ORDINAL_NUMBER INTEGER
  , STEP_TYPE CHAR(4)
  , EXEC_TARGET VARCHAR(8)
  );

CREATE TABLE MAPA_JCL_JOB_STEP_DD
  ( JCL_DD_KEY                CHAR(36) 
    PRIMARY KEY
  , JCL_JOB_STEP_KEY          CHAR(36) 
    REFERENCES MAPA_JCL_JOB_STEP
    ON DELETE CASCADE
  , DD_NAME                   VARCHAR(255)
  , CONCATENATION_NUMBER      INTEGER
  , FILE_TYPE                 CHAR(1)
  , FILE_NAME                 VARCHAR(255)
  , DISP_STATUS               CHAR(3)
  , DISP_NORMAL_TERMINATION   VARCHAR(8)
  , DISP_ABNORMAL_TERMINATION VARCHAR(8)
  );

CREATE TABLE MAPA_JCL_PROC_STEP_DD
  ( JCL_DD_KEY                CHAR(36) 
    PRIMARY KEY
  , JCL_PROC_STEP_KEY         CHAR(36) 
    REFERENCES MAPA_JCL_PROC_STEP
    ON DELETE CASCADE
  , DD_NAME                   VARCHAR(255)
  , CONCATENATION_NUMBER      INTEGER
  , FILE_TYPE                 CHAR(1)
  , FILE_NAME                 VARCHAR(255)
  , DISP_STATUS               CHAR(3)
  , DISP_NORMAL_TERMINATION   VARCHAR(8)
  , DISP_ABNORMAL_TERMINATION VARCHAR(8)
  );

CREATE TABLE MAPA_JCL_JOB_STEP_TSOCALL
  ( JCL_TSOCALL_KEY   CHAR(36) 
    PRIMARY KEY
  , JCL_JOB_STEP_KEY  CHAR(36) 
    REFERENCES MAPA_JCL_JOB_STEP
    ON DELETE CASCADE
  , EXEC_TARGET       VARCHAR(8)
  );

CREATE TABLE MAPA_JCL_PROC_STEP_TSOCALL
  ( JCL_TSOCALL_KEY   CHAR(36) 
    PRIMARY KEY
  , JCL_PROC_STEP_KEY CHAR(36) 
    REFERENCES MAPA_JCL_PROC_STEP
    ON DELETE CASCADE
  , EXEC_TARGET       VARCHAR(8)
  );

CREATE TABLE MAPA_JCL_JOB_STEP_DSNRUN
  ( JCL_DSNRUN_KEY    CHAR(36) 
    PRIMARY KEY
  , JCL_JOB_STEP_KEY  CHAR(36) 
    REFERENCES MAPA_JCL_JOB_STEP
    ON DELETE CASCADE
  , EXEC_TARGET       VARCHAR(8)
  , PLAN_NAME         VARCHAR(8)
  );

CREATE TABLE MAPA_JCL_PROC_STEP_DSNRUN
  ( JCL_DSNRUN_KEY    CHAR(36) 
    PRIMARY KEY
  , JCL_PROC_STEP_KEY CHAR(36) 
    REFERENCES MAPA_JCL_PROC_STEP
    ON DELETE CASCADE
  , EXEC_TARGET       VARCHAR(8)
  , PLAN_NAME         VARCHAR(8)
  );

CREATE TABLE MAPA_JCL_JOB_STEP_DD_AMP
  ( JCL_DD_AMP_KEY    CHAR(36)
    PRIMARY KEY
  , JCL_DD_KEY CHAR(36) 
    REFERENCES MAPA_JCL_JOB_STEP_DD
    ON DELETE CASCADE
  , AMP_PARM          VARCHAR(8)
  , AMP_PARM_VALUE    VARCHAR(63)
  );

CREATE TABLE MAPA_JCL_PROC_STEP_DD_AMP
  ( JCL_DD_AMP_KEY    CHAR(36)
    PRIMARY KEY
  , JCL_DD_KEY CHAR(36) 
    REFERENCES MAPA_JCL_PROC_STEP_DD
    ON DELETE CASCADE
  , AMP_PARM          VARCHAR(8)
  , AMP_PARM_VALUE    VARCHAR(63)
  );


